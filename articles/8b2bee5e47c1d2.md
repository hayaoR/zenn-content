---
title: "RustをRustたらしめているもの"
emoji: "🐥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Rust"]
published: false
---

## はじめに
Rustは魅力的な点が多すぎて、色々な人がご自身のRustの好きな点について言及します。
なのでIT初心者の方の中には「Rustのいいところって色々言われているけど結局なにが最大の特徴なの？」と思う人もいると思います。
したがってこの記事ではおそらく多くの人間が同意するであろうRustをRustたらしめている特徴を2点紹介したいと思います。(とても陳腐な内容です。)
とはいえ私の勘違いの可能性もあるので、ご指摘があればコメント頂けると嬉しいです。

## GCがないのにメモリ安全
世の中にはGCがあって安全な言語(Go, Java, Python,etc..)とGCがなくて安全じゃない言語(C, C++)があります。
GCがあるとStop the worldと言うのですが予測不能なタイミングでプログラムが一時停止してしまいます。多くのプログラムにおいてこの特徴は問題にならないのですが、OSやデータベース管理システム、ミドルウェアなどGCによる一時停止が許容できないソフトウェアが存在します。
そのようなソフトウェアは従来C/C++で書かれてきました。しかし、C/C++はメモリ安全性の保証がプログラマに任されているため、メモリ安全が保証できていないプログラムも多く、著名なソフトウェアにもメモリ安全性に関わるバグがたくさんあるらしいです。
GCとメモリ安全は二者択一だと思われていたのです。
そこに「GCとメモリ安全は二者択一じゃないよ」といって現れたがRustです。
Rustは所有権、借用、ライフタイムという概念を導入することで、GCなしでメモリ安全性を保証することに成功しました。
なので本来Rustが本領発揮できる場所というのはCやC++が活躍していた/している場所です。しかしRustは他にも魅力的な機能がたくさんあるため、別にGCがあっても良いような領域でも使う人は少なくありません。

## unsafe
Rustを使うとコンパイラがメモリ安全性を保証してくれます。
ただし、コンパイラは安全性は保証できないけど、非常に効率的に動くコードはたくさん存在します。
そのような処理を実装できなければ、Rustは非常に非効率な言語になってしまうでしょう。
そのような処理を実装したいときに使うのがunsafeという機能です。
unsafeにはunsafeブロックとunsafe関数があります。このブロック、関数の中ではunsafeな機能が使えます。(他のunsafe関数の呼び出しや生ポインタの参照解決など)
unsafeブロック、unsafe関数に書かれたコードの安全性を保証するのはプログラマの責任です。
unsafeなコードに関してはコンパイラはこう思っているといっていいでしょう。

> 「ワイ(コンパイラ)はそのコードの安全性を全く保証できないから**お前**の責任で安全性を保証しろよ。もしそれが守られなければワイが生み出すコードの動作はまったく保証できないで」

unsafeという存在があることによって、我々はコンパイラによる保証を受けながら、安全で高効率なコードが書けるという訳です。(Safe Rustに留まっている限りは)

## おわりに
この記事ではRustの最大の特徴2点を紹介しました。
とはいえ私はITエンジニアとしてのレベルが相当低いため、Rustが好きなのは上記2点が主な理由ではなく、主にトレイト、ジェネリクス、代数的データ型、パターンマッチ、マクロなどクールな機能がたくさん入っていることが理由です。
所有権、参照、ライフタイムは書いていてたまに苦しむので、GCがあってもいい場面ではGo言語にトレイト、ジェネリクス、代数的データ型、パターンマッチ、マクロが入ったような言語が使いたいなあと思います。


## 参考文献
https://www.oreilly.co.jp/books/9784873119786/